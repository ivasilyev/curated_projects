# Получение последовательностей ДНК человеческого генома

```shell script
# Создать конечные папки
mkdir -p hg38 no_hg38

# Скачать и распаковать референс
curl -fsSL  `# Скачать архив с HG38` \
    "https://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz" 2>/dev/null \
| zcat -  `# Распаковать "на лету"`\
> hg38/hg38.fasta  # Перенаправить в файл

# Просмотреть содержимое папки 
ls hg38

# Просмотреть содержимое референса 
head hg38/hg38.fasta
```

# Индексация референса

```shell script
export IMG="quay.io/biocontainers/bowtie2:2.4.4--py37h13ad519_0" && \
docker pull "${IMG}" && \
docker run --rm --net=host -it -v /data1:/data1 -w "$(pwd)" "${IMG}" bash
```
```shell script
# Запустить программу
bowtie2-build \
    --threads "$(nproc)"  `# Вести расчеты на всех доступных потоках` \
    hg38/hg38.fasta  `# Входные референсные последовательности` \
    hg38/hg38_mask  `# Маска выходных референсных индексов` \
| tee hg38/bowtie2-build.log  # Добавить логирование

# Просмотреть содержимое папки 
ls hg38
```

# Картирование на референс

```shell script
# Запустить программу
bowtie2 \
    --gbar 1  `# Убрать результаты с пробелами в районе начала или конца рида` \
    --local  `# Добавить результаты с неполными ридами` \
    --mp 3  `# Убрать результаты со слишком большим числом следующих подряд несовпадений` \
    --threads "$(nproc)"  `# Вести расчеты на всех доступных потоках` \
    --un-conc no_hg38/Saur__unmapped  `# Маска выходных ридов, которые ниуда не картировались` \
    -1 cutadapt/Saur_S01_L001_R1_001__cut.fastq  `# Входные риды` \
    -2 cutadapt/Saur_S01_L001_R2_001__cut.fastq \
    -D 20  `# Число попыток выравнивания каждого участка` \
    -L 3  `# Длина каждого участка выравнивания` \
    -N 1  `# Число попыток выравнивания внутри каждого участка` \
    -R 3  `# Число попыток генерации участков выравнивания` \
    -S hg38/Saur__mapped.sam  `# Файл с картированными последовательностями ` \
    -x hg38/hg38_mask  `# Маска входных референсных индексов` \
|& tee hg38/bowtie2.log  # Добавить логирование

# Просмотреть содержимое папки 
ls hg38

# Просмотреть, сколько ридов не картировалось 
grep ' aligned 0 times' hg38/bowtie2.log

# Дать права на чтение/запись остальным пользователям
chmod -fR a+rw hg38 no_hg38

# Выйти из контейнера
exit
```
